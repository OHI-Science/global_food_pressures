---
title: "Extended Data Fig. 1"
output:
  html_document:
    toc: yes
    toc_float: yes
    toc_depth: 5
  pdf_document:
    toc: yes
    toc_depth: '5'
---

```{r setup, include=FALSE, echo=FALSE}
library(tidyverse)
library(here)
library(stringr)
library(cowplot)
source(here("_workflow/common.R"))
source(here("_workflow/common_spatial.R"))
```

```{r, include = FALSE}
food_list        <- 
  str_extract(list.files("/home/shares/food-systems/Food_footprint/all_food_systems/analysis/figures/SI_pressure_maps"),
              pattern = "(?<=._).*(?=.tif)")
food_list        <- na.omit(food_list)
livestock_list   <- unique(food_list[!grepl(food_list, pattern = "wildcaught|fisheries|aquaculture|crop")])
CF_list          <- unique(food_list[grepl(food_list, pattern = "wildcaught|fisheries")])
mariculture_list <- unique(food_list[grepl(food_list, pattern = "aquaculture")])
crop_list        <- unique(food_list[grepl(food_list, pattern = "crop")])
crop_list <- crop_list[!grepl(crop_list, c("ofib", "xcof", "teas", "toba"))]

SPAM_names <- 
  vroom::vroom(here("crop/farm/data/crop_codes_updated.csv")) %>% 
  dplyr::select(2, 4) %>% 
  mutate(SPAM_full_name = case_when(SPAM_super == "xpul" ~ "Other pulses",
                                    SPAM_super == "xoil" ~ "Other oil crops",
                                    SPAM_super == "xmil" ~ "Millet",
                                    SPAM_super == "xfru" ~ "Fruits",
                                    SPAM_super == "tnut" ~ "Treenuts",
                                    SPAM_super == "spis" ~ "Spices",
                                    TRUE ~ Hmisc::capitalize(SPAM_full_name))) %>% 
  filter(!SPAM_super == "ofib") %>% 
  add_row(SPAM_super = "fodd",
          SPAM_full_name = "Fodder") %>% 
  unique()

alphanum <- 
  tibble::tibble(letter = c("A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"),
                 number = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26))
```

***

#### Extended Data Fig. 1a

**Crop pressure maps**

Cumulative and individual (disturbance, GHG, water, nutrient) pressures for 26 crop categories (includes production for feed, human consumption, and other uses). The individual pressure maps describe the rescaled pressure data, calculated by dividing each pixel value (e.g., m^3^ water consumption) by the total global pressure across all food systems and pixels, such that each pixel describes its proportional contribution to the global total for that pressure. These values were then multiplied by one million to prevent artefacts from small values. The cumulative pressure score was calculated by summing the rescaled pressure layers. Colour ramp scaling is unique to each plot so the relative spatial distribution of each food item can be more easily visualised.  

```{r, warning = FALSE, echo = FALSE, message = FALSE, results = "asis", cache=FALSE}

for (i in seq_along(crop_list)) {

    val <- crop_list[i]
  
    cat('\n***\n')
    
    cat('\n#####',
        paste(i, ")", sep = ""),
        Hmisc::capitalize(SPAM_names$SPAM_full_name[SPAM_names$SPAM_super == str_sub(val, 1, 4)]),
       '\n')

    cat(paste0("![](", here(sprintf("_analysis/figures/extended_data/output/ed_fig_1_png/%s_final.png", val)), ")"), "\n")

}
```

***

<br />

#### Extended Data Fig. 1b

**Livestock pressure maps**

Cumulative and individual (disturbance, GHG, water, nutrient) pressures for eleven livestock categories. Data includes both on-farm pressures and off-farm feed pressures. The individual pressure maps describe the rescaled pressure data, calculated by dividing each pixel value (e.g., m^3^ water consumption) by the total global pressure across all food systems and pixels, such that each pixel describes its proportional contribution to the global total for that pressure. These values were then multiplied by one million to prevent artefacts from small values. The cumulative pressure score was calculated by summing the rescaled pressure layers. Colour ramp scaling is unique to each plot so the relative spatial distribution of each food item can be more easily visualised.  

```{r, warning = FALSE, echo = FALSE, message = FALSE, results = "asis"}

for (i in seq_along(livestock_list)) {
      
    val <- livestock_list[i]
  
    cat('\n***\n')
    
    cat('\n#####',
        paste(i, ")", sep = ""),
        if_else(Hmisc::capitalize(gsub("_|-", " ", val)) == "Chickens eggs&meat", 
           "Chickens eggs and meat", 
           Hmisc::capitalize(gsub("_|-", " ", val))),
        '\n')
    
    cat(paste0("![](", here(sprintf("_analysis/figures/extended_data/output/ed_fig_1_png/%s_final.png", val)), ")"), "\n")
    
}
```

***

#### Extended Data Fig. 1c 

**Capture fisheries pressure maps**

Cumulative and individual (disturbance, GHG, water, nutrient) pressures for seven categories of marine fisheries and one category of freshwater fisheries. The individual pressure maps describe the rescaled pressure data, calculated by dividing each pixel value (e.g., m^3^ water consumption) by the total global pressure across all food systems and pixels, such that each pixel describes its proportional contribution to the global total for that pressure. These values were then multiplied by one million to prevent artefacts from small values. The cumulative pressure score was calculated by summing the rescaled pressure layers. Colour ramp scaling is unique to each plot so the relative spatial distribution of each food item can be more easily visualised.

```{r, warning = FALSE, echo = FALSE, message = FALSE, results = "asis"}

for (i in seq_along(CF_list)) {

    val <- CF_list[i]
  
    cat('\n***\n')
   
    cat('\n#####',
        paste(i, ")", sep = ""),
        case_when(val == "fofm_fisheries" ~ "Marine fish oil fish meal fisheries", 
                  val == "wildcaught_freshwater" ~ "Freshwater fisheries",
                  TRUE ~ paste("Marine", gsub("_|-", " ", val))),
        '\n')
    
    cat(paste0("![](", here(sprintf("_analysis/figures/extended_data/output/ed_fig_1_png/%s_final.png", val)), ")"), "\n")
        
}
```

***

#### Extended Data Fig. 1d

**Marine aquaculture pressure maps**

Cumulative and individual (disturbance, GHG, water, nutrient) pressures for six categories of marine aquaculture. Data includes both on-farm pressures and off-farm feed pressures (except for unfed or algae fed shellfish). The individual pressure maps describe the rescaled pressure data, calculated by dividing each pixel value (e.g., m^3^ water consumption) by the total global pressure across all food systems and pixels, such that each pixel describes its proportional contribution to the global total for that pressure. These values were then multiplied by one million to prevent artefacts from small values. The cumulative pressure score was calculated by summing the rescaled pressure layers. Colour ramp scaling is unique to each plot so the relative spatial distribution of each food item can be more easily visualised.    

```{r, warning = FALSE, echo = FALSE, message = FALSE, results = "asis"}

for (i in seq_along(mariculture_list)) {
      
    val <- mariculture_list[i]
  
    cat('\n#####',
        paste(i, ")", sep = ""),
        Hmisc::capitalize(gsub("_|-", " ", val)),
        '\n')

    cat(paste0("![](", here(sprintf("_analysis/figures/extended_data/output/ed_fig_1_png/%s_final.png", val)), ")"), "\n")
    
    cat('\n***\n')
    
}
```

