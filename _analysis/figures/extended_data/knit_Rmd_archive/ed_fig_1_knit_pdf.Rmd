---
title: "Extended Data Fig. 1"
output:
  pdf_document: null
  html_document:
    df_print: paged
fig_width: 7.20472
fig_height: 6.3
fig.align: center
fontsize: 7
mainfont: Helvetica
---

```{r setup, include=FALSE, echo=FALSE}
library(tidyverse)
library(here)
library(stringr)
library(cowplot)
source(here("_workflow/common.R"))
source(here("_workflow/common_spatial.R"))
```

```{r, include = FALSE}
food_list        <- 
  str_extract(list.files("/home/shares/food-systems/Food_footprint/all_food_systems/analysis/figures/SI_pressure_maps"),
              pattern = "(?<=._).*(?=.tif)")
food_list        <- na.omit(food_list)
livestock_list   <- unique(food_list[!grepl(food_list, pattern = "wildcaught|fisheries|aquaculture|crop")])
livestock_list[3] <- "chickens_eggs_and_meat"
CF_list          <- unique(food_list[grepl(food_list, pattern = "wildcaught|fisheries")])
mariculture_list <- unique(food_list[grepl(food_list, pattern = "aquaculture")])
crop_list        <- unique(food_list[grepl(food_list, pattern = "crop")])
crop_list <- crop_list[!grepl(crop_list, c("ofib", "xcof", "teas", "toba"))]

SPAM_names <- 
  vroom::vroom(here("crop/farm/data/crop_codes_updated.csv")) %>% 
  dplyr::select(2, 4) %>% 
  mutate(SPAM_full_name = case_when(SPAM_super == "xpul" ~ "Other pulses",
                                    SPAM_super == "xoil" ~ "Other oil crops",
                                    SPAM_super == "xmil" ~ "Millet",
                                    SPAM_super == "xfru" ~ "Fruits",
                                    SPAM_super == "tnut" ~ "Treenuts",
                                    SPAM_super == "spis" ~ "Spices",
                                    TRUE ~ Hmisc::capitalize(SPAM_full_name))) %>% 
  filter(!SPAM_super == "ofib") %>% 
  add_row(SPAM_super = "fodd",
          SPAM_full_name = "Fodder") %>% 
  unique()
```

**Extended Data Fig. 1:** Cumulative and individual (disturbance, GHG, water, nutrient) pressures for four food systems; 1a) 27 crop categories (includes production for feed, human consumption, and other uses), 1b) 11 livestock categories, 1c) 8 categories of marine fisheries and one category of freshwater fisheries, and 1d) 6 categories of marine aquaculture. The individual pressure maps describe the rescaled pressure data, calculated by dividing each pixel value (e.g., m^3^ water consumption) by the total global pressure across all food systems and pixels, such that each pixel describes its proportional contribution to the global total for that pressure. These values were then multiplied by one million to prevent artefacts from small values. The cumulative pressure score was calculated by summing the rescaled pressure layers. Colour ramp scaling is unique to each plot so the relative spatial distribution of each food item can be more easily visualised.  

\newpage

**Extended Data Fig. 1a:** Cumulative and individual (disturbance, GHG, water, nutrient) pressures for 27 crop categories (includes production for feed, human consumption, and other uses).  

```{r, warning = FALSE, echo = FALSE, message = FALSE, results = "asis", cache=FALSE}

for (i in seq_along(crop_list)) {

    val <- crop_list[i]
    cat('<div style="width:691.2px; height:604.8px">')
    cat(paste0("![](", here(sprintf("_analysis/figures/extended_data/output/ed_fig_1_png/%s_final.png", val)), ")"))
    cat("</div>")
        
    cat("&nbsp;", 
        paste(i, ")", " ", Hmisc::capitalize(SPAM_names$SPAM_full_name[SPAM_names$SPAM_super == str_sub(val, 1, 4)]), sep = ""))
}
```

\newpage

**Extended Data Fig. 1b:** Cumulative and individual (disturbance, GHG, water, nutrient) pressures for eleven livestock categories. Data includes both on-farm pressures and off-farm feed pressures.

```{r, warning = FALSE, echo = FALSE, message = FALSE, results = "asis"}

for (i in seq_along(livestock_list)) {

    val <- livestock_list[i]
    
    cat('<div style="width:691.2px; height:604.8px">')
    cat(paste0("![](", here(sprintf("_analysis/figures/extended_data/output/ed_fig_1_png/%s_final.png", val)), ")"))
    cat("</div>")
    
    cat("&nbsp;", 
        paste(i, ")", " ", Hmisc::capitalize(gsub("_|-", " ", val)), sep = ""),
        '\n')

}
```

\newpage

**Extended Data Fig. 1c:** Cumulative and individual (disturbance, GHG, water, nutrient) pressures for eight categories of marine fisheries and one category of freshwater fisheries.

```{r, warning = FALSE, echo = FALSE, message = FALSE, results = "asis"}

for (i in seq_along(CF_list)) {

    val <- CF_list[i]
    
    cat('<div style="width:691.2px; height:604.8px">')
    cat(paste0("![](", here(sprintf("_analysis/figures/extended_data/output/ed_fig_1_png/%s_final.png", val)), ")"), "\n")
    cat("</div>")
    
    cat("&nbsp;", 
        paste(i, ")", " ",
        case_when(val == "fofm_fisheries" ~ "Marine fish oil fish meal fisheries",
                  val == "wildcaught_freshwater" ~ "Freshwater fisheries",
                  TRUE ~ paste("Marine", gsub("_|-", " ", val))), sep = ""),
        '\n')

}
```

\newpage

**Extended Data Fig. 1d:** Cumulative and individual (disturbance, GHG, water, nutrient) pressures for six categories of marine aquaculture. Data includes both on-farm pressures and off-farm feed pressures (except for unfed or algae fed shellfish).

```{r, warning = FALSE, echo = FALSE, message = FALSE, results = "asis"}

for (i in seq_along(mariculture_list)) {

    val <- mariculture_list[i]
    
    cat('<div style="width:691.2px; height:604.8px">')
    cat(paste0("![](", here(sprintf("_analysis/figures/extended_data/output/ed_fig_1_png/%s_final.png", val)), ")"), "\n")
    cat("</div>")

    cat("&nbsp;", 
        paste(i, ")", " ",
        Hmisc::capitalize(gsub("_|-", " ", val)), sep = ""),
        '\n')

}
```

